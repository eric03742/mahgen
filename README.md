# ğŸ€„ï¸mahgen

[English](./README.EN.md) | ä¸­æ–‡

![](https://img.shields.io/npm/l/mahgen) | 
![](https://img.shields.io/npm/v/mahgen) | 
![](https://img.shields.io/npm/types/mahgen)

`mahgen` æ˜¯ä¸€ä¸ªä¸ºç»™å®šçš„æ—¥æœ¬éº»å°†çš„ç‰Œå‹ç”Ÿæˆå¯¹åº”ç‰Œé¢å›¾ç‰‡çš„å·¥å…·åº“ã€‚`mahgen` æ˜¯ ***Mah**jong* ***Gen**erator* çš„ç¼©å†™ã€‚

---

## ç‰¹æ€§

`mahgen` æ”¯æŒå„ç§ç‰Œå‹çš„è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼š

* åŸºæœ¬ç‰Œå‹

![å›½å£«æ— åŒ](docs/images/kokushimusou.png)

![ä¹è²å®ç¯](docs/images/churenpoto.png)

* åƒ

![åƒ](docs/images/chi.png)

* ç¢°

![ç¢°](docs/images/pong.png)

* æ 

![æ ](docs/images/kan.png)

* çº¢å®ç‰Œ

![çº¢å®ç‰Œ](docs/images/red.png)

ä½ å¯ä»¥è®¿é—® [è¿™ä¸ªç½‘ç«™](https://eric200203.github.io/mahgen/) åœ¨çº¿ç”Ÿæˆè‡ªå·±æƒ³è¦çš„ç‰Œå‹å›¾ç‰‡ï¼Œå¹¶å°†å®ƒä»¬ä¿å­˜åˆ°æœ¬åœ°ç”¨äºå…¶ä»–ç”¨é€”ã€‚ä¾‹å¦‚ï¼Œä¸Šé¢å±•ç¤ºçš„éº»å°†ç‰Œå‹å›¾ç‰‡éƒ½æ˜¯ä½¿ç”¨è¿™ä¸ªç½‘ç«™ç”Ÿæˆçš„ã€‚

---

## å®‰è£…

ä½¿ç”¨ `npm` å³å¯å®‰è£…ï¼š

```shell
npm install --save mahgen
```

---

## å¿«é€Ÿä¸Šæ‰‹

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ `mahgen` çš„ç®€å•ç¤ºä¾‹ï¼š

```javascript
import {ErrorCode, Mahgen, ParseError} from "mahgen";

try {
    const res = await Mahgen.render('1m2m3m');
    const node = document.querySelector('#mahjong');
    node.src = res;
} catch(e) {
    if(e instanceof ParseError) {
        console.log(`ErrorCode: ${ErrorCode[e.code]}, ErrorIndex: ${e.index}!`);
    }
}
```

---

## ç”¨æ³•

`mahgen` çš„å…¬å¼€æ¥å£åªæœ‰ä¸‹é¢è¿™ä¸€ä¸ªå‡½æ•°ï¼š

```
Mahgen.render(seq: string): Promise<string>;
```

å…¶ä¸­ï¼š

* å‚æ•° `seq` æ˜¯ç”¨äºæè¿°ç‰Œå‹çš„å­—ç¬¦ä¸²åºåˆ—ï¼ˆå…¶è¯­æ³•è§ä¸‹èŠ‚ï¼‰ï¼›
* è¿”å›å€¼æ˜¯æ‰€ç”Ÿæˆçš„å›¾ç‰‡ç»“æœçš„ base64 æ•°æ®ï¼Œå®ƒå¯ä»¥ç”¨äºå¦‚ HTML ä¸­ `<img>` æ ‡ç­¾çš„ `src` å±æ€§ã€‚

è¯·æ³¨æ„è¿™æ˜¯ä¸€ä¸ªå¼‚æ­¥å‡½æ•°ï¼Œå› æ­¤ä½ å¯èƒ½éœ€è¦ä½¿ç”¨ `await` å…³é”®å­—æˆ– `.then()` æ–¹æ³•è·å–å…¶æ‰§è¡Œç»“æœã€‚

å¦‚æœè¾“å…¥çš„åºåˆ—ä¸ç¬¦åˆè¯­æ³•è§„èŒƒï¼Œåˆ™è¯¥å‡½æ•°ä¼šæŠ›å‡ºç±»å‹ä¸º `ParseError` çš„å¼‚å¸¸ï¼Œä½ å¯ä»¥ä½¿ç”¨ `try...catch` è¯­å¥æˆ– `.catch()` æ–¹æ³•å°†å…¶æ•è·ã€‚`ParseError` å¼‚å¸¸ç±»åŒ…å«ä¸‹é¢ä¸¤ä¸ªæˆå‘˜ï¼š

* `code`ï¼š`ErrorCode` ç±»å‹çš„æšä¸¾ï¼Œè¡¨ç¤ºé”™è¯¯çš„ç±»åˆ«ï¼›
* `index`ï¼šè¡¨ç¤ºé”™è¯¯å‡ºç°çš„ä½ç½®ï¼ˆä¸‹æ ‡ä»0å¼€å§‹ï¼‰ã€‚

---

## è¯­æ³•

### æ•°ç‰Œï¼ˆé¥¼ã€ç´¢ã€ä¸‡ï¼‰

åœ¨æ—¥æœ¬éº»å°†ä¸­ï¼Œé€šå¸¸ä½¿ç”¨æ•°å­— `1-9` æè¿°ç‰Œçš„ç‚¹æ•°ï¼Œä½¿ç”¨å­—æ¯ `p`ã€`s`ã€`m` æè¿°ç‰Œçš„ç±»å‹ *é¥¼ Pin*ã€*ç´¢ So*ã€*ä¸‡ Man*ã€‚å› æ­¤ï¼Œåºåˆ— `1m2m3m` å°±è¡¨ç¤ºç‰Œå‹ *ä¸€ä¸‡äºŒä¸‡ä¸‰ä¸‡*ï¼Œ`5p6p7p` åˆ™è¡¨ç¤º *äº”é¥¼å…­é¥¼ä¸ƒé¥¼*ã€‚

> *1m2m3m*
> 
> ![1m2m3m](./docs/images/1m2m3m.png)

> *5p6p7p*
>
> ![5p6p7p](./docs/images/5p6p7p.png)

ç‰¹åˆ«åœ°ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•°å­— `0` è¡¨ç¤ºçº¢å®ç‰Œï¼Œå› æ­¤ `0p`ã€`0s`ã€`0m` åˆ†åˆ«è¡¨ç¤º *çº¢äº”é¥¼ã€çº¢äº”ç´¢ã€çº¢äº”ä¸‡*ï¼š

> *0pã€0sã€0m*
> 
> ![0p0s0m](./docs/images/0p0s0m.png)

ä¸ºäº†ç®€åŒ–ä¹¦å†™ï¼Œä½ å¯ä»¥å°†åŒä¸€ç±»å‹çš„ç‰Œçš„ç±»å‹æè¿°å…¨éƒ¨çœç•¥ï¼Œåªä¿ç•™æœ€åä¸€ä¸ªã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥å°†ä¸Šæ–‡ä¸­çš„ `1m2m3m` ç®€å†™ä¸º `123m`ï¼Œ`5p6p7p` ç®€å†™ä¸º `567p`ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥å†™ä½œ `1m23m` æˆ– `12m3m`ï¼Œå®ƒä»¬éƒ½è¡¨ç¤º *ä¸€ä¸‡äºŒä¸‡ä¸‰ä¸‡* è¿™ä¸ªç‰Œå‹ã€‚

### å­—ç‰Œï¼ˆé£ç‰Œã€ä¸‰å…ƒç‰Œï¼‰

æ—¥æœ¬éº»å°†ä½¿ç”¨å­—æ¯ `z` è¡¨ç¤ºå­—ç‰Œï¼Œä¸”å­—ç‰Œçš„é¡ºåºä¸º"ä¸œå—è¥¿åŒ—ç™½å‘ä¸­"ï¼Œå› æ­¤ `1z 2z 3z 4z 5z 6z 7z` å°±åˆ†åˆ«è¡¨ç¤º *ä¸œ å— è¥¿ åŒ— ç™½ å‘ ä¸­*ã€‚

> *1z 2z 3z 4z 5z 6z 7z*
> 
> ![1234567z](./docs/images/1234567z.png)

åœ¨æ­¤åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ `0z` è¡¨ç¤º *ç‰ŒèƒŒ*ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `0z11p0z` è¡¨ç¤º *æš—æ ä¸€é¥¼*ï¼š

> *0z11p0z*
> 
> ![0z11p0z](./docs/images/0z11p0z.png)

æœ€åï¼Œä¸ºäº†è®©æ‰€æœ‰çš„æ•°å­—å¯¹å­—ç‰Œéƒ½æœ‰æ„ä¹‰ï¼Œæˆ‘ä»¬ä½¿ç”¨ `8z` å’Œ `9z` è¡¨ç¤ºä¸¤å¼ å¹¶ä¸åœ¨æ—¥æœ¬éº»å°†ä¸­å‡ºç°ã€ä½†å¯èƒ½æœ‰ç”¨å¤„çš„ç‰Œï¼š *? å’Œ &ast;*ã€‚

> *8zã€9z*
> 
> ![8z9z](./docs/images/8z9z.png)

å’Œæ•°ç‰Œä¸€æ ·ï¼Œå­—ç‰Œä¹Ÿå¯ä»¥ç®€å†™ï¼Œä¾‹å¦‚ `3z3z3z` å¯ä»¥ç®€å†™ä¸º `333z`ã€‚

## ç©ºæ ¼

æˆ‘ä»¬ä½¿ç”¨ `|` åœ¨ä¸¤å¼ ç‰Œä¹‹é—´æ’å…¥ *ç©ºæ ¼*ï¼Œæ¯ä¸ªç©ºæ ¼æ˜¯ 1/7 å¼ ç‰Œçš„å®½åº¦ã€‚ä¾‹å¦‚ï¼š

> *123p|456s|789m*
> 
> ![123p|456s|789m](./docs/images/123p456s789m.png)

ä½ å¯ä»¥è¿ç»­ä½¿ç”¨å¤šä¸ª `|` æ’å…¥å¤šä¸ªè¿ç»­çš„ç©ºæ ¼æ¥æ§åˆ¶ä¸¤å¼ ç‰Œä¹‹é—´ç©ºæ ¼çš„å®½åº¦ï¼š

> *123p||||456s*
> 
> ![123p||||456s](./docs/images/123p%7C%7C%7C%7C456s.png)

## å‰¯éœ²

å‰¯éœ²æ—¶ï¼Œéº»å°†ç‰Œå¯èƒ½ä¼šå‘ç”Ÿä»¥ä¸‹ä¸‰ç§å˜åŒ–ï¼šæ¨ªç½®ã€åŠ æ ä»¥åŠæ¶‰åŠçº¢å®ç‰Œçš„åŠ æ ã€‚

### æ¨ªç½®

æˆ‘ä»¬ä½¿ç”¨å‰ç¼€ `_` è¡¨ç¤ºå°†ç´§æ¥ç€çš„ä¸‹ä¸€å¼ ç‰Œæ¨ªç½®ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `_123m` è¡¨ç¤º *ä½¿ç”¨äºŒä¸‡å’Œä¸‰ä¸‡åƒä¸Šå®¶æ‰“å‡ºçš„ä¸€ä¸‡*ï¼š

> *_123m*
> 
> ![_123m](./docs/images/_123m.png)

è¿™é‡Œæœ‰æ›´å¤šçš„ç¤ºä¾‹ï¼š

> *1_11s*
>
> ![1_11s](./docs/images/1_11s.png)

> *777_7p*
>
> ![777_7p](./docs/images/777_7p.png)

### åŠ æ 

æˆ‘ä»¬ä½¿ç”¨å‰ç¼€ `^` è¡¨ç¤ºç´§æ¥ç€çš„ä¸‹ä¸€å¼ ç‰Œæ˜¯åŠ æ å½¢æˆçš„é‡å ã€‚ä¾‹å¦‚ï¼š

> *77^7z*
> 
> ![77^7z](./docs/images/77=7z.png)

### æ¶‰åŠçº¢å®ç‰Œçš„åŠ æ 

æˆ‘ä»¬ä½¿ç”¨å‰ç¼€ `v` è¡¨ç¤ºç´§æ¥ç€çš„ä¸‹ä¸€å¼ ç‰Œæ˜¯åŠ æ å½¢æˆçš„é‡å ï¼Œä¸”å…¶ä¸­æœ‰ä¸€å¼ ç‰Œæ˜¯çº¢å®ç‰Œã€‚æˆ‘ä»¬å®šä¹‰ï¼š`v0` è¡¨ç¤ºé‡å ä¸­é ä¸‹çš„ç‰Œæ˜¯çº¢å®ç‰Œï¼Œé ä¸Šçš„ç‰Œæ˜¯æ™®é€šæ•°ç‰Œï¼›`v5` è¡¨ç¤ºé‡å ä¸­é ä¸‹çš„ç‰Œæ˜¯æ™®é€šæ•°ç‰Œï¼Œé ä¸Šçš„ç‰Œæ˜¯çº¢å®ç‰Œã€‚ä¾‹å¦‚ï¼š

> *55v5p*
> 
> ![55v5p](./docs/images/55v5p.png)

> *5v05s*
> 
> ![5v05s](./docs/images/5v05s.png)

> *v555m*
> 
> ![v555m](./docs/images/v555m.png)

### æ€»ç»“

`mahgen` çš„è¯­æ³•åŸºæœ¬éµå¾ªæ—¥æœ¬éº»å°†æè¿°ç‰Œå‹çš„æƒ¯ä¾‹ï¼Œå¹¶åœ¨å…¶åŸºç¡€ä¸Šè¿›è¡Œæ‰©å±• ï¼š

* ä½¿ç”¨ `1-9` æè¿°ç‰Œçš„ç‚¹æ•°ï¼›
* ä½¿ç”¨åç¼€ `pã€sã€mã€z` è¡¨ç¤ºç‰Œçš„ç±»å‹ï¼šé¥¼ã€ç´¢ã€ä¸‡å’Œå­—ç‰Œï¼›
* ä½¿ç”¨ `0` è¡¨ç¤ºçº¢å®ç‰Œï¼Œ`0z` åˆ™è¡¨ç¤ºç‰ŒèƒŒï¼›
* ä½¿ç”¨ `|` æ’å…¥ç©ºæ ¼ï¼›
* ä½¿ç”¨å‰ç¼€ `_` è¡¨ç¤ºå°†ç‰Œæ¨ªç½®ï¼Œ`^` è¡¨ç¤ºåŠ æ ï¼Œ`v` è¡¨ç¤ºæ¶‰åŠçº¢å®ç‰Œçš„åŠ æ ã€‚

å°†è¿™äº›ç¬¦å·ç»„åˆèµ·æ¥ï¼Œæˆ‘ä»¬å°±èƒ½å¤Ÿæ„é€ å‡ºå„ç§å„æ ·çš„ç‰Œå‹ï¼Œä¾‹å¦‚ï¼š

> *1m|_123p|5v05m|0z11s0z|66^6z*
> 
> ![1m|_123p|5v05m|0z11s0z|66^6z](./docs/images/complicated.png)

æœ€åï¼Œ`mahgen` åªä¸ºç»™å®šçš„åºåˆ—ç”Ÿæˆå›¾ç‰‡ï¼Œä¸ä¼šå¯¹åºåˆ—æ˜¯å¦ç¬¦åˆç‰Œç†è¿›è¡Œæ£€æŸ¥ï¼Œå› æ­¤è¯¸å¦‚ `_5^50v0m` çš„åºåˆ—å¯¹ `mahgen` è€Œè¨€åŒæ ·æ˜¯åˆæ³•çš„ã€‚

---

## åç»­å¼€å‘è®¡åˆ’

* æ”¯æŒç¼©æ”¾ç­‰å‚æ•°è®¾ç½®
* æ”¯æŒç‰Œæ²³æ¨¡å¼æ˜¾ç¤º

---

## è‡´è°¢

* æ„Ÿè°¢ [@black-desk](https://github.com/black-desk) ï¼Œä»–çš„é¡¹ç›® [mahjim](https://github.com/black-desk) ä¸ºæœ¬é¡¹ç›®æä¾›äº†çµæ„Ÿã€‚
* æ„Ÿè°¢ [æœ€å®Œæ•´çš„æ—¥æœ¬éº»å°†ä¸­æ–‡ç»´åŸºç™¾ç§‘](http://wiki.lingshangkaihua.com/mediawiki/index.php/%E9%A6%96%E9%A1%B5)ï¼Œæœ¬é¡¹ç›®çš„å›¾ç‰‡ç´ ææ¥æºäºè¿™ä¸ªç½‘ç«™ã€‚

---

## è®¸å¯è¯

[MIT](./LICENSE)
